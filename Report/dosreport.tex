% This is samplepaper.tex, a sample chapter demonstrating the
% LLNCS macro package for Springer Computer Science proceedings;
% Version 2.20 of 2017/10/04
%
\documentclass[runningheads]{llncs}
%
\usepackage{graphicx}
% Used for displaying a sample figure. If possible, figure files should
% be included in EPS format.
%
% If you use the hyperref package, please uncomment the following line
% to display URLs in blue roman font according to Springer's eBook style:
% \renewcommand\UrlFont{\color{blue}\rmfamily}

\begin{document}

\title{Casper CTF: Solutions}


\author{Siebe Dreesen}
\institute{}

\maketitle       

\section{Overview }
\begin{table}[]
\centering

\begin{tabular}{cll}
\multicolumn{1}{c|}{Level} & Password                                              & Time spent \\ \hline
\multicolumn{1}{c|}{3}     & \multicolumn{1}{l|}{mlHvsSM2qDSqIK1bOyixamw7O7igKdBF} & 10 minutes \\
\multicolumn{1}{c|}{4}     & \multicolumn{1}{l|}{HikOeJRoG2kYCI1QrHBf0bouflFWStPy} & 4 hours    \\
\multicolumn{1}{c|}{5}     & \multicolumn{1}{l|}{}                                 &            \\
\multicolumn{1}{c|}{6}     & \multicolumn{1}{l|}{}                                 &            \\
\multicolumn{1}{c|}{61}    & \multicolumn{1}{l|}{}                                 &            \\
\multicolumn{1}{c|}{62}    & \multicolumn{1}{l|}{}                                 &            \\
\multicolumn{1}{c|}{63}    & \multicolumn{1}{l|}{}                                 &            \\
\multicolumn{1}{c|}{7}     & \multicolumn{1}{l|}{}                                 &            \\
\multicolumn{1}{c|}{8}     & \multicolumn{1}{l|}{}                                 &            \\ \hline
Total                      &                                                       &           
\end{tabular}
\end{table}

\section{Casper 4 solution}
\subsection{Description}
This program takes 1 argument as input, if more are given it will print the first argument and stop the program immediately. The program contains a struct which contains a buffer of 775 characters and a function pointer. When less then 2 arguments are given the first will be copied into the buffer of the struct using strcpy() and the function pointer will be called. Normally this function pointer will point to the greetUser function which will print string.

\subsection{Vulnerability}
This program contains a memory management vulnerability, specifically a buffer overflow vulnerability. The struct contains a buffer and a function pointer which will be allocated under the buffer and the strcpy() which will copy the first argument does not do bounds checking. This means the buffer can be overflowed and the function pointer can be overwritten by giving an argument that is bigger than the allocated space for the buffer (775 bytes). 

\subsection{Exploit description}
The vulnerability can be exploited by giving a well-chosen argument that is bigger than the buffer space and overwrites the function pointer. The argument contains shell code which will spawn the /bin/xh shell. The specific argument is build from the following bytes:
\begin{itemize}
	\item A NOP sled of 755 byte
	
	\item The shell code of 22 bytes
	\item Address of the sled which will be pointed to the shell code and overwrites the function pointer
\end{itemize}
This argument will be copied to the buffer and overwrite the function pointer with the right address. By using a NOP sled the exploit becomes more robust because any address in the sled can be called to execute the shell code.

\subsection{Mitigation}
A possible mitigation would be to use strncpy() instead of srtcpy() which will only copy N characters and the buffer will never overflow. Other possible mitigations are non-executable data so that the shell code cannot be executed or address space layout randomisation which will make it harder to point to the right address of the shellcode.

\section{Casper 5 solution}
\subsection{Description}
\subsection{Vulnerability}
\subsection{Exploit description}
\subsection{Mitigation}

\section{Casper 6 solution}
\subsection{Description}
\subsection{Vulnerability}
\subsection{Exploit description}
\subsection{Mitigation}
\subsection{Advanced levels}

\section{Casper 7 solution}
\subsection{Description}
\subsection{Vulnerability}
\subsection{Exploit description}
\subsection{Mitigation}

\section{Casper 8 solution}
\subsection{Description}
\subsection{Vulnerability}
\subsection{Exploit description}
\subsection{Mitigation}

\end{document}
